@model BookDto
@{
}

<head>
    <style>
        .star-rating {
            display: inline-block;
            font-size: 2rem;
            color: #ccc;
            cursor: pointer;
            user-select: none;
        }

        .star-rating span.filled {
            color: gold;
        }
    </style>
</head>

<div class="row">
    <div class="col-md-8 mx-auto rounded border p-3">
        <h2 class="text-center mb-5">New Book</h2>

        <form method="post" enctype="multipart/form-data">
            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Title</label>
                <div class="col-sm-8">
                    <input class="form-control" asp-for="title">
                    <span asp-validation-for="title" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Year of publication</label>
                <div class="col-sm-8">
                    <input class="form-control" asp-for="publicationYear">
                    <span asp-validation-for="publicationYear" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Author</label>
                <div class="col-sm-8">
                    <input class="form-control" asp-for="author">
                    <span asp-validation-for="author" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Genre</label>
                <div class="col-sm-8">
                    <select name="genre" id="genre" class="form-control" asp-for="genre">
                        <option value="" selected disabled hidden>Choose here</option>
                        <option value="Fantasy">Fantasy</option>
                        <option value="Sci-Fi">Science Fiction</option>
                        <option value="Mystery">Mystery</option>
                        <option value="Thriller">Thriller</option>
                        <option value="Romance">Romance</option>
                        <option value="Horror">Horror</option>
                        <option value="Hist-Fi">Historical Fiction</option>
                        <option value="Contemp-Fi">Contemporary Fiction</option>
                        <option value="Biography">Biography </option>
                        <option value="Self-Help">Self-Help</option>
                        <option value="Science">Science</option>
                        <option value="History">History</option>
                        <option value="YA">Young Adult</option>
                        <option value="Children">Children’s</option>
                        <option default value="Other">Other</option>
                    </select>
                    <span asp-validation-for="genre" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Status</label>
                <div class="col-sm-8">
                    <select name="status" id="status" class="form-control" asp-for="Status">
                        <option value="Unentered" selected disabled hidden>Choose here</option>
                        <option value="Owned">Owned</option>
                        <option value="Not-Owned">Want to buy</option>
                    </select>
                    <span asp-validation-for="Status" class="text-danger"></span>
                </div>
            </div>

            <div id="completion-div" class="row mb-3 d-none">
                <label class="col-sm-4 col-form-label">Completion</label>
                <div class="col-sm-8">
                    <select name="completion" id="completion" class="form-control" asp-for="Completion">
                        <option value="want">Want to read</option>
                        <option value="reading">Reading</option>
                        <option value="finished">Finished</option>
                    </select>
                    <span asp-validation-for="Completion" class="text-danger"></span>
                </div>
            </div>

            <div id="ratings-div" class="row mb-3 d-none">
                <label class="col-sm-4 col-form-label">Rating</label>
                <div id="rating" class="col-sm-8 star-rating">
                    <span data-value="1">&#9734;</span>
                    <span data-value="2">&#9734;</span>
                    <span data-value="3">&#9734;</span>
                    <span data-value="4">&#9734;</span>
                    <span data-value="5">&#9734;</span>
                    <input type="hidden" id="ratingValue" name="starRating" value="0" />
                </div>
            </div>

            <div id="review-div" class="row mb-3 d-none">
                <label class="col-sm-4 col-form-label">Review</label>
                <div class="col-sm-8">
                    <textarea class="form-control" asp-for="review" placeholder="Write your review here..." rows="10" cols="50"></textarea>
                    <span asp-validation-for="review" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <label class="col-sm-4 col-form-label">Image</label>
                <div class="col-sm-8">
                    <input class="form-control" asp-for="ImageFile">
                    <span asp-validation-for="ImageFile" class="text-danger"></span>
                </div>
            </div>

            <div class="row">
                <div class="offset-sm-4 col-sm-4 d-grid">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
                <div class="col-sm-4 d-grid">
                    <a class="btn btn-outline-primary" asp-controller="Books" asp-action="Index" role="button">Cancel</a>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    const statusWheel = document.getElementById("status");
    const completionWheel = document.getElementById("completion");

    const completionDiv = document.getElementById("completion-div");
    const ratingsDiv = document.getElementById("ratings-div");
    const reviewDiv = document.getElementById("review-div");

    statusWheel.addEventListener("click", () => {
        if (statusWheel.value == "Owned") {
            completionDiv.classList.remove("d-none");
        } else {
            completionDiv.classList.add("d-none");
        }
    })

    completionWheel.addEventListener("click", () => {
        if (completionWheel.value == "finished") {
            ratingsDiv.classList.remove("d-none");
            reviewDiv.classList.remove("d-none");
        } else {
            ratingsDiv.classList.add("d-none");
            reviewDiv.classList.add("d-none");
        }
    })
</script>

<script>
    const stars = document.querySelectorAll("#rating span");
    const ratingInput = document.getElementById("ratingValue");

    stars.forEach(star => {
        star.addEventListener("click", () => {
            const value = parseInt(star.getAttribute('data-value'));
            ratingInput.value = value;

            stars.forEach(s => {
                s.classList.remove("filled");

                if(parseInt(s.getAttribute('data-value')) <= value) {
                    s.classList.add("filled");
                    s.innerHTML = "&#9733;"
                } else {
                    s.innerHTML = "&#9734;"
                }
            });
        })
    })
</script>